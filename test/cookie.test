package require tcltest
eval ::tcltest::configure $argv
# Ensure package is loaded from ./package rather than /usr/lib/tcltk
set auto_path [linsert $auto_path 0 ./package]
package require qcode

namespace eval ::qcode::test {
    namespace import ::tcltest::*
    namespace path ::qc

    test cookie_string2multimap-1.0 {} -body {
        return [qc::cookie_string2multimap {foo=bar}]
    } -result {foo bar}

    test cookie_string2multimap-1.1 {} -body {
        return [qc::cookie_string2multimap {foo=bar; qu="baz"}]
    } -result {foo bar qu baz}

    test cookie_string2multimap-1.2 {} -body {
        return [qc::cookie_string2multimap {foo=bar; qu="baz"; foo=apple}]
    } -result {foo bar qu baz foo apple}

    test cookie_string2multimap-1.3 {} -body {
        return [qc::cookie_string2multimap {foo=bar=baz; qu=test}]
    } -result {foo bar=baz qu test}

    test cookie_string2multimap-1.4 {} -body {
        return [qc::cookie_string2multimap {foo%20bar=qu%20baz}]
    } -result {{foo bar} {qu baz}}

    cleanupTests
}
namespace delete ::qcode::test
